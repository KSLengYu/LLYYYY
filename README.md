LYMessage-Board ç•™è¨€æ¿ç³»ç»Ÿ

ä¸€ä¸ªæ”¯æŒ é‚®ç®±éªŒè¯ç ç™»å½•ã€å¯†ç ç™»å½•ã€QQ ç»‘å®šã€æ¸¸å®¢ç•™è¨€ã€ç”¨æˆ·èµ„æ–™ä¿®æ”¹ã€ç®¡ç†å‘˜åå° çš„å…¨åŠŸèƒ½ç•™è¨€æ¿ç³»ç»Ÿã€‚
ä½¿ç”¨ Vercel Serverless Functions + Supabase ä½œä¸ºåç«¯ï¼Œå‰ç«¯ä¸ºåŸç”Ÿ HTML + JSï¼Œé€‚åˆä¸ªäººç½‘ç«™ä½¿ç”¨ã€‚

âœ¨ åŠŸèƒ½ç‰¹ç‚¹
ğŸ” èº«ä»½ç³»ç»Ÿ

é‚®ç®±éªŒè¯ç ç™»å½•ï¼ˆå…å¯†ç ï¼‰
å¯†ç ç™»å½•ï¼ˆå¯è®¾ç½®ã€ä¿®æ”¹ã€é‡ç½®å¯†ç ï¼‰
QQ ç¬¬ä¸‰æ–¹ç»‘å®š / è§£ç»‘
ç”¨æˆ·èµ„æ–™ç¼–è¾‘ï¼šæ˜µç§°ã€å¤´åƒã€é‚®ç®±
ä¼šè¯åŸºäº JWT + Cookieï¼ˆHttpOnlyã€å®‰å…¨ï¼‰

ğŸ’¬ ç•™è¨€ç³»ç»Ÿ
ç”¨æˆ·ç™»å½•åå¯ç•™è¨€
æ¸¸å®¢æ¨¡å¼ç•™è¨€ï¼ˆå¯é…ç½®å¼€å¯ï¼‰
æ”¯æŒå›å¤ã€ç‚¹èµã€åˆ é™¤ï¼ˆç®¡ç†å‘˜ï¼‰

ğŸ‘‘ ç®¡ç†å‘˜ç³»ç»Ÿ
æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨
å°ç¦ / è§£å°ç”¨æˆ·
ç®¡ç†å‘˜æƒé™ç®¡ç†ï¼ˆä¸»ç®¡ç†å‘˜å¯æŒ‡å®šç®¡ç†å‘˜ï¼‰
å®‰å…¨è®¿é—®ï¼ˆAdmin API éœ€ç®¡ç†å‘˜ JWTï¼‰

ğŸ”§ ç³»ç»Ÿç‰¹æ€§
Serverless å•æ–‡ä»¶ APIï¼ˆv1 è·¯ç”±ç»Ÿä¸€ï¼‰
CORS è‡ªåŠ¨å¤„ç†
å¤š SMTP è½®è¯¢é˜²æ­¢å‘é€å¤±è´¥
å¯æ‰©å±•æ€§å¼ºã€ç»´æŠ¤ç®€å•

ğŸ“‚ ç›®å½•ç»“æ„ï¼ˆæœ€ç»ˆç‰ˆï¼‰
LYMessage-Board/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ v1.js              # æ‰€æœ‰ API åˆå¹¶åˆ°ä¸€ä¸ªæ–‡ä»¶
â”‚   â”œâ”€â”€ utils.js           # å…¬å…±å·¥å…·ï¼ˆJWT, Supabase, é‚®ä»¶ç­‰ï¼‰
â”‚
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ login.html
â”‚   â”œâ”€â”€ register.html
â”‚   â”œâ”€â”€ verify.html
â”‚   â”œâ”€â”€ profile.html
â”‚   â”œâ”€â”€ admin.html
â”‚   â””â”€â”€ assets/
â”‚       â””â”€â”€ default-avatar.png
â”‚
â”œâ”€â”€ package.json
â”œâ”€â”€ vercel.json
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md

âš™ï¸ ç¯å¢ƒå˜é‡ï¼ˆVercel / æœ¬åœ°ï¼‰
åœ¨ .env æˆ– Vercel > Project Settings > Environment Variables ä¸­æ·»åŠ ï¼š
Supabase
SUPABASE_URL=https://xxx.supabase.co
SUPABASE_SERVICE_KEY=ä½ çš„service_role_key
SUPABASE_ANON_KEY=å¯é€‰

JWT
JWT_SECRET=éšæœºå¤æ‚å­—ç¬¦ä¸²

SMTPï¼ˆæ”¯æŒå¤šä¸ªï¼‰
SMTP_COUNT=2

SMTP_1_HOST=smtp.qq.com
SMTP_1_PORT=465
SMTP_1_SECURE=true
SMTP_1_USER=demo@qq.com
SMTP_1_PASS=æˆæƒç 

SMTP_2_HOST=smtp.gmail.com
SMTP_2_PORT=587
SMTP_2_SECURE=false
SMTP_2_USER=your@gmail.com
SMTP_2_PASS=xxx

ğŸ› ï¸ å®‰è£…ä¸è¿è¡Œ
æœ¬åœ°å¯åŠ¨ï¼ˆå¸¦ API ä»£ç†ï¼‰
npm install
vercel dev

éƒ¨ç½²åˆ° Vercel
ä»£ç æäº¤ â†’ è‡ªåŠ¨æ„å»º â†’ è‡ªåŠ¨ä¸Šçº¿
Vercel ä¼šè‡ªåŠ¨è¯†åˆ« api/v1.js ä¸º Serverless Functionã€‚
ğŸ—„ï¸ Supabase Database Schemaï¼ˆSQLï¼‰
åœ¨ Supabase SQL Editor è¿è¡Œä»¥ä¸‹è„šæœ¬ï¼š

users è¡¨
create table users (
  id bigint generated by default as identity primary key,
  email text unique,
  password_hash text,
  qq_id text,
  qq_name text,
  qq_avatar text,
  name text,
  role text default 'user',
  is_banned boolean default false,
  created_at timestamptz default now()
);

otps è¡¨ï¼ˆéªŒè¯ç ï¼‰
create table otps (
  id bigint generated by default as identity primary key,
  email text,
  otp_hash text,
  used boolean default false,
  expires_at timestamptz,
  created_at timestamptz default now()
);

messages è¡¨
create table messages (
  id bigint generated by default as identity primary key,
  user_id bigint,
  text text,
  likes int default 0,
  replies jsonb default '[]',
  created_at timestamptz default now()
);

ğŸ‘‘ å¦‚ä½•æ·»åŠ ç®¡ç†å‘˜ï¼ˆSupabase æ§åˆ¶å°ï¼‰
è¿è¡Œ SQLï¼š
update users set role='admin' where email='ä½ çš„é‚®ç®±';

ä¸»ç®¡ç†å‘˜å»ºè®®æ‰‹åŠ¨æŒ‡å®šï¼š
update users set role='superadmin' where email='ä½ çš„é‚®ç®±';
ä¸»ç®¡ç†å‘˜æ‰æœ‰æƒé™ä»»å‘½å…¶ä»–ç®¡ç†å‘˜ã€‚
ğŸ”§ API ç»Ÿä¸€è·¯ç”±ï¼ˆv1.jsï¼‰
æ‰€æœ‰ API å·²ç»Ÿä¸€åˆ°ï¼š
/api/v1


é€šè¿‡ action åŒºåˆ†ï¼š
ç¤ºä¾‹ï¼š
POST /api/v1?action=login
POST /api/v1?action=send_otp
POST /api/v1?action=verify_otp
POST /api/v1?action=update_profile
...

å‡å°‘ 12+ ä¸ª Serverless å‡½æ•°é™åˆ¶ã€‚

ğŸ“Œ å·²é€‚é…çš„å‰ç«¯é¡µé¢
login.html
register.html
verify.html
profile.html
admin.html
index.htmlï¼ˆç•™è¨€æ¿ä¸»é¡µï¼‰
æ‰€æœ‰é¡µé¢å·²æ›´æ–°ï¼Œé€‚é… v1 APIï¼ŒåŠ¨ç”»æ•ˆæœã€å›¾æ ‡æ ·å¼ã€æŒ‰é’®çŠ¶æ€å·²ä¼˜åŒ–ã€‚

ğŸ› ï¸ ç»´æŠ¤æ–¹å¼ï¼ˆæ¨èï¼‰
æ‰€æœ‰åç«¯é€»è¾‘éƒ½åœ¨ api/v1.js ä¸­
æ–°å¢åŠŸèƒ½åªéœ€å¾€ switch(action) ä¸­æ·»åŠ ä¸€ä¸ªåˆ†æ”¯
utils.js æä¾›å¸¸ç”¨å‡½æ•°ï¼ˆSupabaseã€JWTã€Cookieã€SMTPâ€¦ï¼‰
å‰ç«¯åªéœ€è¦è°ƒç”¨ fetch('/api/v1?action=xxx')

ä¼˜åŠ¿
ä¸ä¼šå†å‡ºç° "è¶…è¿‡ 12 ä¸ª Serverless Functions" çš„é—®é¢˜
æ›´å®¹æ˜“è°ƒè¯•
Vercel å•å‡½æ•°éƒ¨ç½²æ›´å¿«
Supabase ä¸€å¥— schema æ°¸ä¹…é€šç”¨

ğŸ“ License
è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹ï¼Œä¸è¦æ±‚ä¿ç•™ç‰ˆæƒã€‚